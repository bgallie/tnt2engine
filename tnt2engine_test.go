// This is free and unencumbered software released into the public domain.
// See the UNLICENSE file for details.

package tnt2engine

import (
	"bufio"
	"io"
	"math/big"
	"os"
	"reflect"
	"testing"
)

func TestTnt2Engine_Left(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	tnt2Machine.SetEngineType("E")
	tnt2Machine.BuildCipherMachine()
	defer tnt2Machine.CloseCipherMachine()
	tests := []struct {
		name string
		want chan CipherBlock
	}{
		{
			name: "ttel1",
			want: tnt2Machine.left,
		},
	}
	for _, tt := range tests {
		e := tnt2Machine
		t.Run(tt.name, func(t *testing.T) {
			if got := e.Left(); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("Tnt2Engine.Left() = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestTnt2Engine_Right(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	tnt2Machine.SetEngineType("E")
	tnt2Machine.BuildCipherMachine()
	defer tnt2Machine.CloseCipherMachine()
	tests := []struct {
		name string
		want chan CipherBlock
	}{
		{
			name: "tter1",
			want: tnt2Machine.right,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			if got := e.Right(); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("Tnt2Engine.Right() = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestTnt2Engine_CounterKey(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tests := []struct {
		name             string
		key              string
		proFormaFileName string
		want             string
	}{
		{
			name:             "ttec1",
			key:              "SecretKey",
			proFormaFileName: "",
			want:             "ab2677fa2eecca36541ea85fd8d871203383b898bb025b8ec8fd5f24719eee1c",
		},
		{
			name:             "ttec2",
			key:              "SecretKey",
			proFormaFileName: "files/test.proforma.json",
			want:             "9d468a888bf287c0cdc3008569b76c0cb7091b062f0b6209461436534392f95c",
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			tnt2Machine.Init([]byte(tt.key), tt.proFormaFileName)
			if got := tnt2Machine.CounterKey(); got != tt.want {
				t.Errorf("Tnt2Engine.CounterKey() = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestTnt2Engine_Index(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	iCnt, _ := new(big.Int).SetString("1234567890", 10)
	tnt2Machine.SetIndex(iCnt)
	tests := []struct {
		name     string
		wantCntr *big.Int
	}{
		{
			name:     "ttei1",
			wantCntr: iCnt,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			if gotCntr := e.Index(); !reflect.DeepEqual(gotCntr, tt.wantCntr) {
				t.Errorf("Tnt2Engine.Index() = %v, want %v", gotCntr, tt.wantCntr)
			}
		})
	}
}

func TestTnt2Engine_SetIndex(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	iCnt, _ := new(big.Int).SetString("1234567890", 10)
	type args struct {
		iCnt *big.Int
	}
	tests := []struct {
		name string
		args args
		want *big.Int
	}{
		{
			name: "ttesi1",
			args: args{iCnt},
			want: iCnt,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			e.SetIndex(tt.args.iCnt)
			if got := e.Index(); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("Tnt2Engine.Index() = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestTnt2Engine_SetEngineType(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	type args struct {
		engineType string
	}
	tests := []struct {
		name string
		args args
	}{
		{
			name: "tteset1",
			args: args{"E"},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			e.SetEngineType(tt.args.engineType)
			if got := e.engineType; got != tt.args.engineType {
				t.Errorf("Tnt2Engine.SetEngineType() = %v, want %v", got, tt.args.engineType)
			}
		})
	}
}

func TestTnt2Engine_Engine(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	tnt2Machine.SetIndex(BigZero)
	cnter := new(Counter)
	cnter.SetIndex(BigZero)
	tests := []struct {
		name string
		want []Crypter
	}{
		{
			name: "tnt2e1",
			want: []Crypter{
				new(Rotor).New(8191, 1080, 4661, []byte{
					8, 118, 213, 71, 70, 154, 243, 40, 182, 219, 221, 197, 252, 200, 128, 8,
					56, 156, 184, 57, 228, 54, 211, 88, 25, 53, 228, 153, 173, 38, 197, 178,
					255, 157, 32, 171, 153, 119, 188, 138, 171, 13, 240, 1, 10, 223, 31, 194,
					4, 65, 231, 25, 179, 2, 223, 184, 58, 204, 5, 209, 170, 91, 235, 142,
					222, 203, 175, 206, 21, 39, 55, 67, 91, 56, 41, 124, 25, 115, 136, 166,
					9, 207, 247, 252, 229, 216, 96, 197, 110, 164, 214, 92, 116, 40, 90, 76,
					54, 236, 98, 204, 129, 235, 132, 242, 164, 126, 67, 37, 132, 180, 74, 38,
					13, 22, 230, 158, 252, 128, 9, 26, 0, 202, 119, 149, 156, 138, 64, 132,
					90, 93, 136, 219, 22, 206, 187, 175, 117, 29, 241, 229, 200, 1, 49, 110,
					241, 65, 165, 95, 196, 7, 110, 66, 54, 198, 70, 223, 41, 117, 53, 131,
					138, 147, 149, 207, 225, 105, 94, 38, 189, 130, 175, 214, 56, 201, 124, 37,
					32, 53, 148, 17, 68, 243, 147, 173, 109, 251, 44, 68, 144, 222, 98, 62,
					33, 230, 193, 142, 4, 104, 248, 92, 51, 72, 226, 40, 182, 125, 160, 197,
					24, 109, 95, 29, 203, 184, 66, 50, 154, 149, 87, 170, 245, 209, 169, 164,
					103, 243, 209, 221, 60, 68, 125, 23, 178, 8, 178, 92, 51, 166, 153, 78,
					163, 109, 249, 207, 241, 60, 18, 46, 128, 107, 112, 106, 67, 190, 131, 71,
					20, 35, 61, 209, 154, 205, 170, 173, 23, 189, 198, 39, 198, 118, 205, 139,
					48, 88, 126, 158, 57, 211, 60, 170, 24, 50, 178, 240, 248, 172, 105, 182,
					70, 183, 204, 193, 208, 246, 97, 83, 75, 149, 92, 71, 99, 217, 7, 80,
					207, 180, 238, 157, 183, 119, 248, 155, 199, 246, 96, 21, 163, 11, 79, 57,
					193, 191, 113, 136, 193, 219, 12, 31, 177, 51, 127, 161, 29, 251, 3, 62,
					243, 220, 151, 148, 90, 207, 36, 110, 47, 118, 39, 33, 55, 89, 57, 108,
					140, 8, 23, 24, 59, 114, 121, 62, 206, 247, 97, 192, 126, 148, 91, 250,
					132, 111, 88, 50, 215, 246, 84, 102, 196, 16, 215, 67, 66, 67, 25, 91,
					82, 17, 54, 51, 85, 135, 21, 207, 76, 160, 25, 60, 175, 158, 5, 215,
					158, 17, 188, 148, 178, 72, 192, 163, 205, 72, 253, 49, 200, 133, 90, 199,
					65, 129, 240, 28, 35, 233, 173, 86, 197, 34, 30, 223, 187, 172, 29, 43,
					190, 184, 202, 60, 120, 128, 212, 130, 142, 156, 73, 110, 213, 129, 230, 11,
					143, 167, 245, 244, 90, 166, 163, 245, 170, 48, 162, 29, 151, 60, 182, 255,
					76, 179, 136, 27, 201, 232, 194, 181, 7, 90, 104, 51, 9, 20, 136, 144,
					93, 23, 33, 178, 35, 186, 176, 156, 123, 220, 209, 54, 65, 61, 155, 149,
					173, 54, 143, 110, 124, 40, 54, 196, 246, 0, 203, 57, 198, 189, 253, 19,
					179, 119, 110, 161, 196, 107, 9, 227, 117, 44, 127, 11, 242, 110, 89, 84,
					197, 218, 244, 203, 112, 38, 193, 244, 62, 27, 100, 88, 122, 249, 125, 92,
					222, 240, 231, 147, 157, 110, 113, 37, 143, 5, 105, 166, 12, 191, 162, 4,
					57, 186, 143, 5, 60, 210, 61, 88, 188, 198, 144, 91, 39, 148, 97, 45,
					24, 224, 168, 118, 55, 232, 100, 183, 170, 4, 60, 243, 44, 12, 40, 108,
					211, 24, 222, 104, 20, 94, 88, 44, 52, 43, 133, 76, 47, 11, 172, 86,
					168, 88, 147, 100, 127, 58, 15, 109, 223, 53, 18, 92, 94, 220, 254, 247,
					106, 35, 115, 214, 241, 212, 202, 139, 233, 170, 43, 163, 77, 130, 130, 139,
					162, 252, 9, 53, 82, 91, 54, 105, 91, 78, 125, 74, 131, 119, 242, 169,
					189, 68, 86, 89, 3, 53, 19, 20, 119, 131, 132, 170, 48, 187, 106, 182,
					62, 206, 67, 137, 46, 37, 190, 65, 115, 121, 10, 156, 59, 168, 130, 112,
					122, 32, 154, 113, 56, 22, 87, 115, 190, 206, 208, 101, 172, 3, 21, 61,
					201, 78, 0, 211, 105, 197, 80, 246, 254, 238, 109, 73, 133, 92, 253, 203,
					171, 16, 139, 172, 157, 247, 235, 16, 129, 44, 166, 37, 178, 202, 165, 22,
					128, 41, 145, 57, 88, 251, 248, 245, 149, 171, 35, 131, 15, 162, 121, 89,
					111, 222, 177, 200, 240, 212, 197, 91, 185, 224, 66, 168, 126, 190, 217, 80,
					119, 210, 133, 44, 68, 120, 113, 40, 57, 92, 214, 79, 62, 20, 220, 71,
					58, 242, 172, 182, 4, 11, 99, 144, 247, 51, 1, 66, 121, 127, 139, 120,
					152, 185, 174, 26, 100, 104, 220, 79, 165, 79, 9, 10, 241, 52, 148, 229,
					65, 179, 110, 163, 68, 233, 82, 45, 124, 93, 20, 48, 76, 65, 92, 179,
					209, 57, 233, 86, 5, 60, 141, 232, 214, 34, 195, 20, 251, 220, 161, 136,
					128, 189, 153, 29, 232, 83, 140, 86, 22, 211, 239, 46, 167, 73, 112, 204,
					8, 127, 86, 13, 173, 111, 192, 35, 101, 181, 67, 24, 150, 214, 182, 212,
					140, 68, 206, 252, 247, 179, 79, 213, 202, 60, 117, 28, 213, 127, 129, 106,
					187, 121, 65, 57, 229, 58, 175, 11, 225, 216, 115, 238, 106, 238, 97, 122,
					51, 57, 218, 213, 241, 135, 122, 187, 107, 76, 179, 180, 108, 66, 116, 156,
					67, 63, 111, 12, 116, 195, 190, 148, 147, 16, 246, 253, 104, 127, 214, 3,
					64, 28, 164, 143, 223, 49, 21, 235, 54, 68, 175, 36, 177, 130, 251, 113,
					250, 21, 17, 136, 113, 176, 83, 120, 41, 206, 47, 173, 92, 75, 130, 170,
					75, 55, 64, 44, 23, 220, 248, 9, 124, 144, 123, 198, 30, 207, 177, 47,
					33, 190, 249, 95, 51, 69, 186, 167, 13, 120, 46, 57, 107, 221, 109, 23,
					38, 167, 147, 31, 135, 243, 190, 177, 24, 28, 44, 254, 147, 195, 182, 87,
					4, 187, 234, 35, 35, 205, 121, 20, 219, 237, 238, 98, 126, 100, 64, 4,
					28, 78, 220, 28, 114, 155, 105, 172, 140, 26, 242, 204, 86, 147, 98, 89}),
				new(Rotor).New(8167, 2336, 6911, []byte{
					85, 73, 34, 126, 135, 213, 240, 102, 62, 168, 172, 80, 113, 140, 114, 109,
					157, 234, 129, 122, 8, 168, 3, 52, 62, 196, 164, 91, 73, 182, 40, 77,
					158, 42, 10, 83, 61, 187, 89, 252, 203, 167, 70, 164, 102, 124, 92, 190,
					197, 207, 233, 210, 14, 72, 133, 27, 125, 28, 48, 162, 234, 2, 101, 68,
					189, 59, 188, 137, 93, 216, 3, 168, 54, 172, 116, 243, 139, 252, 179, 102,
					187, 83, 104, 91, 85, 125, 159, 178, 146, 176, 72, 124, 2, 50, 28, 180,
					166, 44, 66, 224, 71, 207, 93, 175, 104, 156, 117, 76, 130, 209, 204, 121,
					65, 90, 13, 4, 231, 151, 250, 75, 80, 54, 94, 198, 161, 1, 139, 162,
					211, 113, 150, 153, 45, 68, 254, 9, 242, 53, 222, 59, 162, 7, 120, 25,
					244, 159, 117, 191, 238, 10, 161, 113, 103, 163, 98, 79, 237, 220, 170, 226,
					47, 136, 227, 255, 94, 58, 154, 100, 222, 151, 9, 95, 20, 67, 61, 249,
					35, 167, 38, 67, 115, 150, 88, 219, 130, 155, 39, 244, 178, 205, 26, 197,
					28, 142, 116, 211, 218, 52, 169, 195, 93, 174, 12, 231, 121, 12, 98, 20,
					16, 245, 27, 31, 153, 119, 26, 199, 94, 234, 218, 75, 157, 228, 102, 39,
					104, 217, 8, 129, 161, 169, 62, 110, 17, 239, 65, 244, 33, 28, 123, 42,
					193, 110, 140, 252, 221, 124, 243, 76, 163, 211, 201, 195, 82, 241, 171, 235,
					207, 205, 90, 159, 93, 188, 200, 139, 203, 241, 85, 170, 31, 83, 229, 4,
					122, 50, 241, 241, 132, 229, 234, 114, 220, 134, 193, 244, 92, 23, 229, 25,
					150, 183, 251, 243, 104, 176, 4, 139, 160, 133, 51, 255, 167, 7, 122, 98,
					189, 27, 53, 175, 173, 34, 70, 10, 189, 94, 80, 211, 209, 72, 5, 249,
					178, 52, 212, 223, 41, 62, 149, 144, 64, 66, 5, 41, 226, 27, 15, 191,
					134, 255, 91, 251, 112, 46, 189, 150, 240, 90, 161, 135, 228, 4, 10, 214,
					247, 163, 156, 97, 155, 103, 48, 51, 110, 75, 145, 74, 233, 118, 225, 122,
					40, 78, 103, 186, 129, 36, 85, 159, 225, 150, 99, 82, 245, 26, 120, 102,
					76, 177, 20, 204, 79, 244, 184, 229, 192, 125, 22, 41, 150, 144, 84, 10,
					237, 71, 58, 155, 174, 228, 171, 110, 7, 179, 202, 122, 49, 207, 181, 10,
					88, 195, 50, 156, 33, 173, 172, 157, 16, 172, 92, 25, 116, 6, 220, 103,
					191, 148, 168, 160, 49, 82, 61, 102, 27, 54, 216, 217, 104, 55, 129, 124,
					20, 205, 165, 179, 109, 48, 12, 235, 231, 108, 201, 173, 130, 236, 126, 248,
					46, 110, 78, 21, 33, 140, 209, 208, 104, 254, 59, 183, 80, 107, 35, 22,
					168, 207, 177, 193, 85, 182, 96, 200, 173, 42, 52, 227, 165, 231, 17, 53,
					103, 53, 135, 103, 56, 222, 53, 216, 246, 36, 157, 0, 49, 110, 123, 137,
					61, 239, 116, 63, 211, 85, 209, 141, 242, 147, 210, 193, 251, 97, 250, 246,
					247, 196, 36, 158, 186, 216, 183, 176, 211, 49, 240, 255, 147, 234, 56, 115,
					178, 116, 191, 59, 210, 80, 207, 236, 211, 7, 137, 250, 242, 133, 171, 195,
					247, 80, 213, 15, 223, 84, 225, 103, 34, 228, 177, 74, 120, 233, 137, 128,
					87, 181, 149, 57, 215, 227, 78, 23, 229, 251, 200, 47, 83, 8, 84, 18,
					135, 94, 148, 163, 230, 68, 40, 45, 10, 173, 95, 220, 91, 154, 106, 195,
					182, 153, 64, 220, 172, 25, 145, 13, 84, 44, 31, 170, 99, 3, 4, 31,
					53, 81, 183, 140, 69, 80, 165, 229, 113, 221, 140, 239, 10, 200, 75, 41,
					14, 140, 86, 40, 54, 33, 201, 188, 211, 18, 130, 173, 140, 200, 99, 134,
					69, 227, 46, 170, 124, 162, 55, 18, 147, 112, 174, 200, 239, 76, 3, 162,
					47, 138, 65, 14, 172, 38, 196, 110, 215, 188, 116, 72, 197, 101, 179, 47,
					24, 50, 94, 97, 24, 243, 109, 111, 23, 26, 190, 60, 234, 102, 132, 154,
					176, 6, 224, 153, 221, 96, 20, 77, 221, 230, 99, 40, 233, 255, 28, 222,
					195, 32, 31, 149, 123, 106, 38, 177, 199, 134, 84, 83, 60, 35, 106, 52,
					174, 36, 38, 128, 7, 205, 97, 220, 43, 44, 146, 47, 216, 147, 119, 91,
					185, 108, 173, 50, 79, 145, 34, 87, 228, 124, 49, 219, 46, 77, 162, 184,
					241, 49, 252, 24, 236, 250, 139, 88, 175, 42, 6, 249, 70, 165, 164, 190,
					90, 208, 231, 48, 135, 193, 97, 34, 230, 154, 43, 163, 236, 182, 2, 12,
					61, 108, 16, 41, 76, 198, 199, 128, 243, 53, 40, 196, 97, 118, 165, 226,
					204, 135, 10, 248, 235, 78, 107, 4, 246, 26, 225, 169, 10, 243, 171, 174,
					169, 90, 203, 56, 54, 4, 68, 226, 232, 1, 104, 235, 6, 29, 180, 75,
					77, 63, 15, 123, 205, 65, 25, 67, 131, 118, 7, 110, 55, 213, 141, 198,
					229, 206, 94, 211, 209, 239, 180, 163, 211, 25, 170, 185, 1, 224, 63, 57,
					150, 132, 199, 89, 202, 144, 114, 59, 14, 71, 48, 206, 72, 134, 92, 241,
					66, 206, 100, 108, 104, 216, 48, 74, 189, 96, 24, 175, 109, 211, 68, 29,
					53, 4, 0, 177, 204, 247, 128, 72, 109, 140, 191, 89, 104, 169, 100, 77,
					16, 249, 176, 40, 130, 78, 171, 136, 123, 86, 30, 236, 64, 90, 137, 110,
					249, 205, 181, 222, 62, 88, 216, 179, 249, 250, 41, 156, 159, 65, 73, 229,
					27, 164, 139, 57, 42, 97, 207, 148, 160, 166, 248, 152, 228, 92, 116, 210,
					95, 10, 51, 87, 178, 37, 236, 38, 196, 251, 4, 34, 163, 36, 195, 92,
					14, 187, 19, 215, 194, 12, 101, 106, 103, 111, 89, 225, 37, 74, 24, 200,
					139, 95, 119, 113, 96, 23, 89, 144, 229, 148, 61, 137, 220, 170, 36, 17,
					191, 195, 106, 120, 51, 31, 84, 86, 168, 56, 70, 185, 182, 78, 245, 64,
					61, 4, 212, 1, 26, 31, 98, 210, 173, 36, 91, 148, 166}),
				new(Permutator).New([]int{67, 61, 63, 65}, []byte{
					48, 136, 23, 62, 57, 68, 140, 163, 42, 112, 107, 209, 28, 125, 6, 90,
					33, 214, 234, 56, 253, 235, 9, 103, 149, 172, 65, 133, 230, 212, 191, 86,
					244, 130, 63, 151, 217, 69, 20, 185, 241, 67, 175, 246, 31, 201, 239, 79,
					122, 189, 8, 215, 173, 134, 124, 226, 221, 3, 208, 223, 179, 17, 165, 115,
					83, 232, 91, 156, 181, 108, 82, 45, 15, 30, 183, 152, 147, 176, 193, 101,
					205, 110, 104, 248, 168, 27, 249, 139, 64, 121, 219, 29, 158, 38, 87, 102,
					198, 78, 180, 58, 240, 85, 7, 98, 2, 142, 25, 40, 141, 216, 10, 150,
					36, 99, 204, 229, 127, 116, 34, 61, 255, 238, 72, 132, 43, 237, 35, 166,
					131, 93, 52, 153, 252, 44, 73, 123, 80, 14, 92, 37, 143, 220, 74, 109,
					197, 202, 22, 138, 71, 190, 13, 113, 245, 55, 51, 177, 11, 47, 167, 224,
					81, 250, 154, 97, 184, 1, 148, 195, 46, 251, 53, 120, 70, 111, 144, 77,
					54, 182, 84, 171, 135, 137, 126, 119, 178, 24, 21, 254, 161, 192, 146, 188,
					89, 106, 225, 199, 129, 203, 211, 96, 169, 159, 32, 196, 243, 155, 145, 50,
					206, 174, 200, 88, 18, 160, 157, 117, 242, 100, 194, 128, 26, 0, 19, 5,
					170, 59, 4, 95, 39, 187, 164, 186, 213, 210, 49, 60, 207, 233, 94, 41,
					16, 218, 228, 118, 231, 114, 75, 12, 236, 162, 222, 247, 76, 227, 105, 66}),
				new(Rotor).New(8171, 4772, 259, []byte{
					50, 212, 83, 236, 171, 134, 166, 165, 213, 154, 109, 63, 111, 101, 108, 138,
					177, 83, 79, 32, 194, 70, 75, 236, 232, 110, 208, 105, 226, 131, 235, 91,
					130, 22, 106, 248, 154, 51, 236, 217, 20, 97, 146, 135, 170, 180, 234, 52,
					195, 92, 93, 37, 2, 251, 140, 89, 107, 109, 212, 225, 134, 162, 29, 188,
					226, 116, 11, 222, 156, 223, 196, 88, 8, 20, 106, 15, 61, 200, 102, 206,
					164, 59, 225, 126, 214, 48, 201, 125, 196, 136, 46, 196, 23, 129, 98, 247,
					233, 239, 132, 160, 144, 132, 67, 1, 111, 89, 174, 172, 134, 55, 158, 163,
					215, 142, 0, 81, 247, 76, 155, 190, 1, 11, 234, 75, 242, 150, 44, 126,
					152, 15, 234, 42, 86, 194, 145, 35, 225, 230, 175, 212, 8, 163, 118, 66,
					248, 41, 82, 104, 210, 151, 149, 217, 156, 249, 190, 17, 22, 13, 203, 52,
					137, 241, 249, 71, 175, 85, 107, 95, 119, 57, 45, 22, 5, 250, 202, 134,
					204, 253, 124, 66, 26, 151, 128, 100, 207, 79, 74, 85, 45, 200, 220, 199,
					85, 185, 253, 218, 84, 252, 156, 87, 189, 30, 169, 28, 15, 152, 243, 203,
					111, 159, 110, 165, 120, 181, 109, 161, 184, 121, 60, 92, 242, 12, 84, 9,
					142, 75, 112, 201, 236, 249, 184, 126, 3, 144, 97, 142, 176, 183, 89, 72,
					64, 199, 34, 217, 240, 194, 23, 207, 232, 47, 19, 152, 51, 89, 166, 103,
					160, 63, 17, 164, 37, 72, 197, 253, 180, 221, 233, 157, 128, 247, 70, 37,
					155, 252, 143, 16, 3, 94, 170, 240, 237, 197, 167, 31, 76, 111, 101, 61,
					64, 56, 194, 171, 136, 122, 56, 160, 223, 130, 114, 163, 170, 221, 27, 64,
					151, 16, 17, 218, 21, 72, 1, 69, 200, 160, 134, 226, 36, 223, 229, 8,
					170, 255, 73, 83, 207, 11, 12, 116, 86, 136, 173, 33, 9, 88, 138, 66,
					75, 153, 228, 98, 132, 180, 15, 204, 59, 4, 76, 97, 192, 111, 33, 188,
					240, 60, 66, 68, 113, 133, 219, 255, 201, 120, 209, 149, 136, 183, 186, 61,
					162, 182, 130, 20, 203, 228, 187, 36, 113, 174, 76, 180, 102, 138, 168, 125,
					45, 241, 71, 108, 139, 120, 89, 208, 31, 242, 226, 32, 37, 224, 110, 93,
					48, 231, 21, 185, 17, 166, 116, 215, 146, 186, 184, 14, 187, 204, 183, 74,
					197, 59, 42, 126, 99, 109, 60, 224, 224, 218, 63, 106, 54, 184, 249, 27,
					37, 187, 237, 43, 68, 69, 146, 183, 204, 119, 172, 6, 124, 53, 128, 183,
					192, 49, 226, 28, 189, 145, 170, 207, 117, 184, 48, 94, 198, 123, 0, 159,
					172, 65, 154, 4, 22, 85, 174, 2, 118, 207, 64, 229, 196, 152, 100, 209,
					232, 43, 120, 125, 124, 77, 39, 158, 144, 144, 105, 171, 11, 208, 2, 242,
					113, 128, 119, 104, 29, 20, 252, 197, 146, 22, 58, 151, 5, 156, 20, 205,
					93, 117, 73, 181, 73, 20, 154, 167, 132, 234, 226, 73, 199, 144, 24, 150,
					36, 142, 43, 151, 203, 187, 128, 245, 149, 144, 245, 98, 213, 21, 155, 225,
					9, 40, 228, 236, 34, 217, 224, 225, 6, 237, 242, 176, 190, 61, 50, 202,
					112, 21, 193, 16, 234, 208, 65, 180, 195, 53, 168, 128, 20, 68, 61, 201,
					46, 244, 46, 120, 41, 242, 125, 49, 234, 250, 27, 215, 194, 207, 66, 146,
					50, 93, 205, 77, 219, 8, 4, 40, 107, 68, 237, 121, 84, 66, 147, 170,
					22, 218, 192, 212, 82, 25, 114, 148, 192, 187, 146, 132, 118, 220, 28, 148,
					39, 131, 166, 36, 184, 21, 198, 232, 139, 77, 9, 252, 47, 10, 4, 84,
					10, 81, 65, 185, 18, 161, 81, 227, 228, 83, 73, 119, 187, 58, 70, 61,
					173, 138, 222, 164, 2, 11, 6, 139, 121, 205, 168, 209, 189, 42, 113, 91,
					86, 29, 228, 195, 222, 62, 234, 110, 95, 116, 134, 20, 188, 90, 240, 254,
					210, 131, 46, 194, 97, 122, 113, 146, 218, 202, 144, 214, 97, 153, 121, 205,
					100, 223, 203, 175, 38, 47, 20, 136, 68, 139, 36, 246, 51, 195, 224, 107,
					28, 142, 208, 252, 180, 21, 54, 146, 187, 127, 105, 106, 169, 112, 252, 63,
					176, 50, 193, 31, 66, 231, 184, 97, 153, 34, 187, 210, 32, 105, 108, 141,
					247, 129, 45, 172, 6, 93, 117, 77, 85, 10, 135, 123, 36, 156, 69, 173,
					161, 232, 130, 21, 168, 108, 240, 211, 181, 143, 201, 10, 41, 164, 87, 75,
					199, 45, 239, 48, 135, 73, 162, 175, 16, 23, 250, 45, 216, 242, 72, 61,
					46, 240, 167, 140, 81, 169, 234, 36, 252, 208, 202, 38, 181, 137, 66, 5,
					55, 53, 22, 170, 143, 107, 202, 106, 173, 31, 114, 41, 116, 58, 110, 141,
					229, 116, 74, 143, 107, 49, 242, 65, 196, 21, 240, 127, 213, 228, 4, 173,
					122, 149, 222, 132, 21, 155, 244, 98, 81, 209, 79, 123, 215, 254, 34, 184,
					53, 37, 245, 7, 173, 100, 118, 195, 52, 124, 18, 208, 40, 220, 62, 92,
					180, 164, 154, 169, 91, 212, 87, 20, 187, 82, 242, 95, 113, 192, 36, 118,
					172, 15, 230, 101, 97, 191, 40, 97, 74, 59, 11, 51, 38, 55, 126, 169,
					4, 53, 159, 151, 198, 26, 161, 141, 64, 70, 235, 131, 248, 254, 56, 193,
					194, 230, 78, 203, 233, 226, 186, 45, 106, 230, 154, 167, 247, 164, 167, 114,
					45, 210, 125, 43, 71, 100, 27, 170, 44, 182, 147, 112, 220, 126, 40, 134,
					12, 49, 124, 75, 227, 169, 118, 163, 70, 246, 254, 21, 232, 91, 58, 2,
					251, 44, 245, 120, 169, 139, 82, 71, 182, 46, 55, 17, 110, 169, 240, 252,
					87, 157, 1, 71, 44, 55, 178, 126, 52, 182, 98, 23, 100, 45, 202, 165,
					137, 74, 32, 57, 206, 41, 201, 224, 135, 211, 105, 38, 102, 147, 161, 158,
					98, 95, 53, 52, 45, 173, 214, 108, 251, 121, 43, 99, 83, 140, 157, 122,
					2, 17, 54, 90, 98, 71, 119, 131, 78, 19, 31, 92, 223, 162}),
				new(Rotor).New(8147, 2314, 5212, []byte{
					23, 203, 86, 76, 234, 120, 196, 47, 124, 117, 164, 189, 75, 55, 16, 72,
					47, 13, 168, 82, 235, 220, 111, 154, 98, 85, 255, 193, 92, 23, 21, 200,
					112, 20, 204, 178, 206, 22, 159, 240, 224, 118, 244, 32, 28, 71, 89, 169,
					204, 111, 176, 176, 30, 206, 73, 16, 174, 108, 54, 97, 125, 23, 155, 194,
					229, 137, 154, 245, 188, 7, 4, 86, 15, 63, 149, 210, 179, 3, 49, 52,
					139, 52, 116, 221, 109, 114, 60, 87, 0, 6, 68, 130, 117, 91, 83, 108,
					89, 217, 251, 21, 124, 4, 156, 41, 50, 192, 3, 181, 192, 166, 52, 49,
					230, 136, 55, 1, 121, 94, 183, 23, 241, 195, 159, 245, 81, 114, 184, 56,
					236, 30, 211, 38, 210, 215, 254, 236, 160, 254, 208, 252, 131, 234, 230, 181,
					45, 81, 120, 232, 104, 57, 238, 28, 139, 96, 4, 30, 212, 73, 199, 123,
					121, 71, 48, 186, 156, 212, 89, 123, 123, 157, 158, 67, 169, 13, 62, 4,
					243, 224, 163, 104, 108, 56, 67, 34, 225, 124, 167, 190, 188, 39, 106, 14,
					223, 38, 109, 91, 225, 227, 16, 35, 88, 31, 184, 85, 215, 176, 115, 46,
					42, 43, 154, 113, 231, 55, 105, 214, 15, 131, 141, 145, 117, 87, 210, 68,
					77, 154, 111, 46, 207, 148, 138, 224, 113, 182, 38, 17, 152, 142, 8, 168,
					175, 14, 85, 220, 149, 102, 105, 70, 45, 174, 209, 168, 33, 83, 153, 179,
					10, 138, 149, 194, 163, 229, 44, 242, 235, 211, 59, 178, 77, 202, 106, 117,
					212, 95, 231, 86, 20, 232, 116, 247, 206, 156, 13, 113, 31, 161, 123, 92,
					218, 80, 55, 203, 200, 181, 151, 171, 215, 228, 128, 85, 56, 116, 94, 3,
					246, 195, 100, 88, 90, 64, 68, 109, 141, 172, 6, 132, 11, 211, 204, 32,
					6, 179, 92, 50, 241, 19, 233, 61, 23, 160, 240, 153, 22, 184, 55, 21,
					158, 252, 58, 151, 97, 112, 137, 203, 17, 112, 216, 53, 114, 71, 217, 16,
					189, 154, 53, 220, 23, 73, 16, 23, 124, 140, 182, 41, 50, 195, 106, 65,
					97, 72, 13, 183, 14, 29, 145, 123, 53, 238, 97, 8, 97, 98, 65, 99,
					84, 17, 234, 220, 123, 233, 190, 77, 229, 224, 141, 44, 249, 145, 251, 193,
					182, 36, 210, 116, 200, 188, 145, 74, 128, 3, 32, 3, 31, 194, 239, 207,
					27, 6, 139, 137, 34, 8, 51, 82, 16, 134, 238, 173, 14, 217, 32, 214,
					2, 83, 123, 131, 65, 17, 115, 91, 162, 13, 12, 218, 39, 66, 150, 201,
					193, 152, 135, 174, 167, 129, 243, 31, 31, 154, 226, 94, 180, 0, 78, 187,
					63, 203, 48, 141, 19, 221, 103, 189, 195, 142, 245, 242, 207, 216, 143, 111,
					37, 200, 92, 28, 164, 226, 113, 223, 117, 174, 255, 118, 76, 29, 8, 84,
					37, 155, 194, 167, 215, 70, 70, 69, 156, 153, 36, 214, 223, 26, 84, 1,
					64, 90, 15, 78, 131, 176, 226, 47, 249, 38, 129, 124, 14, 153, 103, 70,
					208, 179, 131, 145, 231, 140, 161, 56, 220, 193, 217, 81, 222, 119, 217, 183,
					120, 252, 2, 49, 73, 67, 101, 127, 117, 6, 149, 4, 75, 222, 152, 84,
					224, 77, 49, 13, 24, 215, 225, 213, 138, 115, 43, 110, 39, 184, 83, 95,
					225, 63, 10, 251, 14, 32, 228, 239, 33, 116, 140, 164, 119, 29, 175, 83,
					0, 72, 18, 75, 122, 154, 30, 16, 174, 39, 231, 78, 182, 56, 161, 219,
					98, 114, 183, 129, 9, 229, 212, 223, 55, 92, 233, 234, 71, 202, 35, 251,
					105, 167, 188, 109, 191, 207, 236, 37, 133, 169, 98, 124, 97, 28, 183, 6,
					64, 58, 219, 120, 106, 134, 153, 162, 15, 97, 9, 31, 52, 1, 107, 64,
					109, 172, 160, 2, 70, 88, 86, 114, 133, 140, 77, 250, 238, 243, 217, 179,
					83, 148, 128, 35, 2, 179, 175, 5, 185, 95, 179, 29, 126, 222, 228, 150,
					53, 115, 241, 24, 24, 233, 89, 21, 47, 58, 86, 233, 253, 5, 56, 61,
					98, 106, 125, 181, 225, 208, 23, 226, 187, 119, 88, 248, 75, 82, 73, 40,
					225, 85, 144, 200, 199, 67, 12, 129, 189, 168, 136, 153, 147, 95, 128, 49,
					172, 254, 230, 59, 219, 19, 228, 229, 180, 157, 175, 57, 124, 183, 242, 250,
					122, 79, 255, 24, 40, 158, 238, 71, 61, 216, 180, 23, 192, 162, 43, 189,
					41, 15, 80, 90, 7, 185, 49, 25, 116, 247, 36, 137, 24, 98, 137, 99,
					237, 233, 222, 245, 113, 201, 114, 209, 4, 47, 245, 224, 211, 239, 19, 49,
					23, 10, 195, 154, 79, 120, 156, 198, 237, 10, 205, 189, 207, 60, 100, 40,
					80, 174, 182, 159, 4, 137, 240, 73, 21, 137, 253, 236, 157, 176, 145, 244,
					20, 150, 4, 28, 245, 209, 7, 89, 226, 50, 133, 188, 57, 155, 191, 201,
					111, 192, 225, 187, 43, 119, 175, 45, 212, 80, 110, 158, 68, 203, 221, 83,
					255, 243, 90, 29, 120, 46, 249, 176, 165, 191, 42, 158, 137, 199, 30, 249,
					243, 85, 108, 88, 85, 146, 51, 216, 170, 150, 188, 244, 78, 103, 202, 171,
					192, 27, 81, 247, 5, 234, 2, 15, 242, 245, 180, 167, 69, 139, 155, 36,
					128, 138, 88, 250, 79, 1, 91, 55, 9, 127, 217, 127, 136, 129, 161, 20,
					158, 10, 201, 220, 171, 255, 86, 69, 212, 98, 80, 222, 158, 57, 109, 62,
					249, 254, 235, 246, 73, 181, 185, 89, 240, 229, 80, 153, 218, 240, 114, 93,
					31, 235, 97, 225, 255, 122, 214, 121, 233, 144, 24, 156, 70, 213, 1, 165,
					161, 233, 186, 49, 164, 154, 118, 51, 52, 169, 39, 182, 185, 180, 251, 180,
					179, 166, 203, 141, 215, 77, 26, 172, 143, 226, 35, 84, 57, 254, 156, 65,
					148, 170, 36, 232, 133, 186, 117, 26, 184, 27, 191, 88, 182, 98, 82, 199,
					35, 126, 225, 171, 35, 237, 93, 186, 129, 64, 122, 105, 64, 149, 90, 231,
					126, 211, 20, 171, 250, 15, 230, 186, 168, 64, 110}),
				new(Permutator).New([]int{65, 67, 71, 53}, []byte{
					34, 130, 6, 156, 60, 16, 58, 37, 185, 47, 154, 224, 213, 133, 246, 77,
					106, 54, 186, 115, 244, 42, 178, 123, 86, 30, 201, 7, 43, 174, 73, 211,
					129, 76, 44, 168, 108, 132, 237, 103, 13, 212, 217, 160, 92, 195, 179, 17,
					1, 68, 189, 170, 169, 67, 240, 250, 147, 227, 171, 226, 107, 234, 164, 151,
					79, 66, 222, 122, 12, 183, 109, 193, 22, 218, 100, 64, 162, 159, 102, 252,
					220, 45, 83, 110, 38, 177, 59, 116, 28, 173, 136, 182, 124, 238, 11, 137,
					20, 158, 89, 114, 78, 190, 113, 196, 127, 74, 93, 126, 87, 245, 25, 84,
					18, 112, 35, 233, 144, 24, 94, 165, 69, 125, 105, 56, 80, 91, 134, 150,
					161, 21, 197, 9, 207, 19, 99, 210, 204, 118, 203, 88, 49, 228, 41, 139,
					75, 98, 153, 221, 255, 236, 205, 208, 0, 4, 140, 32, 141, 57, 149, 241,
					29, 248, 48, 243, 200, 14, 135, 191, 72, 65, 119, 85, 145, 62, 70, 188,
					251, 142, 181, 50, 97, 231, 53, 46, 3, 229, 242, 36, 176, 219, 202, 146,
					111, 215, 128, 172, 121, 10, 71, 117, 31, 157, 8, 55, 138, 235, 148, 167,
					104, 192, 225, 5, 253, 209, 101, 90, 143, 206, 254, 96, 2, 198, 194, 163,
					247, 120, 249, 152, 15, 23, 166, 82, 95, 223, 33, 155, 187, 175, 63, 199,
					214, 239, 216, 61, 131, 27, 230, 51, 81, 232, 180, 52, 39, 40, 26, 184}),
				new(Rotor).New(8161, 484, 1298, []byte{
					82, 203, 226, 58, 134, 223, 93, 148, 237, 87, 201, 97, 120, 39, 6, 104,
					94, 176, 26, 104, 237, 200, 140, 250, 16, 138, 239, 21, 61, 14, 61, 82,
					32, 12, 227, 164, 116, 117, 183, 200, 52, 47, 30, 135, 228, 74, 242, 177,
					81, 249, 240, 126, 95, 183, 152, 54, 21, 138, 110, 0, 103, 5, 195, 171,
					173, 55, 65, 182, 13, 117, 248, 10, 221, 236, 211, 127, 171, 64, 66, 222,
					254, 79, 13, 30, 97, 74, 135, 118, 218, 106, 140, 94, 54, 43, 132, 50,
					156, 152, 118, 83, 215, 252, 151, 99, 111, 151, 73, 128, 188, 238, 87, 91,
					210, 213, 13, 144, 180, 98, 253, 239, 86, 220, 152, 75, 63, 177, 28, 197,
					164, 254, 136, 154, 131, 225, 205, 81, 94, 81, 166, 15, 193, 250, 204, 139,
					133, 75, 95, 52, 252, 236, 232, 251, 60, 94, 190, 24, 222, 126, 78, 189,
					225, 249, 140, 86, 28, 173, 240, 135, 39, 253, 79, 119, 32, 84, 11, 117,
					1, 73, 198, 98, 252, 37, 112, 79, 221, 76, 132, 12, 47, 89, 235, 58,
					226, 124, 110, 184, 225, 168, 182, 152, 240, 149, 252, 177, 157, 68, 42, 192,
					19, 97, 223, 18, 246, 148, 165, 243, 247, 194, 78, 25, 6, 67, 55, 136,
					214, 98, 43, 10, 71, 206, 251, 42, 48, 51, 135, 80, 171, 81, 136, 160,
					224, 156, 239, 167, 158, 110, 68, 28, 32, 184, 97, 245, 253, 60, 233, 230,
					160, 186, 68, 33, 90, 192, 79, 209, 213, 219, 62, 202, 179, 11, 199, 157,
					5, 79, 152, 132, 61, 255, 126, 143, 43, 3, 180, 11, 38, 224, 206, 57,
					234, 206, 11, 134, 106, 37, 133, 174, 25, 144, 48, 148, 217, 13, 56, 246,
					135, 97, 224, 151, 242, 34, 232, 39, 18, 154, 221, 83, 36, 122, 199, 152,
					93, 9, 101, 27, 57, 146, 1, 115, 41, 114, 55, 199, 133, 168, 104, 42,
					69, 132, 14, 165, 138, 169, 176, 242, 113, 173, 118, 138, 10, 152, 160, 109,
					137, 43, 182, 95, 207, 229, 58, 211, 243, 250, 128, 80, 180, 161, 20, 67,
					235, 141, 28, 250, 99, 214, 56, 151, 58, 6, 168, 113, 118, 151, 171, 112,
					31, 50, 95, 177, 130, 34, 149, 27, 205, 224, 133, 56, 131, 21, 103, 41,
					114, 153, 96, 53, 240, 201, 157, 16, 104, 89, 62, 227, 180, 226, 76, 97,
					211, 168, 23, 145, 3, 140, 142, 83, 151, 233, 106, 125, 18, 134, 33, 224,
					171, 231, 151, 98, 112, 33, 137, 90, 200, 234, 121, 198, 9, 136, 57, 241,
					80, 71, 129, 220, 71, 51, 144, 252, 247, 128, 102, 197, 0, 187, 241, 79,
					250, 115, 95, 92, 176, 194, 121, 186, 227, 203, 171, 32, 123, 22, 33, 102,
					212, 218, 238, 3, 243, 102, 201, 30, 66, 0, 160, 188, 15, 36, 151, 122,
					119, 130, 11, 83, 223, 88, 200, 30, 139, 51, 188, 193, 139, 213, 44, 146,
					235, 46, 107, 161, 15, 60, 4, 91, 15, 192, 63, 204, 119, 66, 170, 183,
					71, 167, 42, 28, 86, 214, 60, 82, 200, 116, 177, 0, 240, 173, 93, 30,
					154, 127, 2, 35, 22, 114, 15, 140, 170, 32, 124, 92, 34, 231, 27, 117,
					160, 69, 203, 100, 81, 191, 252, 15, 1, 112, 154, 129, 197, 131, 61, 136,
					142, 56, 96, 190, 0, 219, 17, 204, 57, 214, 205, 59, 252, 157, 208, 176,
					102, 192, 131, 237, 220, 73, 140, 106, 84, 145, 9, 3, 106, 163, 88, 212,
					85, 166, 46, 105, 176, 86, 33, 73, 25, 44, 222, 57, 230, 193, 40, 187,
					191, 153, 123, 189, 72, 95, 231, 172, 160, 222, 252, 166, 176, 13, 212, 107,
					152, 66, 204, 117, 63, 220, 205, 137, 6, 129, 84, 49, 221, 60, 163, 219,
					161, 22, 219, 109, 163, 75, 2, 117, 231, 210, 90, 160, 46, 168, 207, 176,
					237, 72, 149, 84, 175, 178, 214, 93, 67, 48, 91, 99, 155, 96, 204, 177,
					65, 239, 228, 250, 172, 169, 186, 28, 46, 201, 134, 214, 168, 130, 172, 55,
					144, 157, 78, 131, 63, 233, 185, 232, 214, 12, 106, 103, 101, 158, 1, 43,
					109, 159, 126, 250, 233, 195, 151, 35, 79, 139, 213, 4, 150, 53, 122, 142,
					172, 158, 244, 0, 104, 136, 35, 129, 221, 65, 151, 153, 212, 169, 202, 98,
					113, 147, 111, 113, 114, 199, 42, 171, 254, 76, 81, 126, 220, 208, 119, 123,
					241, 34, 63, 39, 23, 14, 72, 63, 176, 154, 19, 69, 40, 2, 98, 125,
					191, 175, 58, 80, 87, 140, 80, 64, 239, 26, 212, 80, 88, 201, 13, 84,
					53, 139, 31, 198, 73, 138, 226, 121, 155, 31, 250, 72, 153, 226, 233, 202,
					76, 203, 29, 122, 86, 205, 36, 240, 193, 222, 253, 164, 234, 49, 199, 170,
					231, 218, 182, 195, 154, 120, 10, 153, 152, 134, 2, 244, 120, 105, 177, 70,
					200, 192, 181, 92, 84, 139, 181, 44, 122, 238, 226, 113, 13, 78, 65, 188,
					135, 149, 187, 224, 60, 164, 55, 155, 24, 73, 43, 167, 18, 80, 41, 145,
					219, 152, 252, 166, 176, 50, 38, 133, 2, 66, 199, 148, 0, 232, 176, 198,
					74, 219, 93, 220, 121, 146, 95, 32, 178, 168, 203, 23, 15, 218, 122, 219,
					92, 70, 223, 226, 165, 104, 183, 131, 250, 148, 111, 195, 88, 154, 211, 84,
					211, 86, 18, 135, 38, 99, 91, 172, 217, 198, 139, 40, 68, 168, 117, 221,
					197, 230, 94, 10, 104, 53, 122, 109, 238, 77, 103, 208, 125, 144, 38, 47,
					31, 161, 7, 121, 81, 145, 141, 51, 249, 45, 198, 131, 137, 65, 147, 193,
					64, 15, 137, 173, 21, 33, 209, 8, 154, 181, 36, 36, 249, 210, 66, 181,
					126, 255, 127, 235, 9, 77, 86, 95, 133, 139, 60, 229, 240, 236, 29, 59,
					110, 174, 190, 231, 25, 124, 57, 212, 59, 86, 225, 229, 165, 150, 197, 117,
					12, 191, 187, 40, 219, 175, 146, 195, 240, 78, 12, 208, 188, 96, 53, 208,
					218, 145, 25, 245, 33, 20, 223, 43, 122, 28, 122, 164, 156}),
				new(Rotor).New(8179, 3352, 2994, []byte{
					26, 9, 213, 239, 127, 14, 159, 75, 220, 251, 100, 72, 17, 216, 4, 87,
					248, 171, 15, 173, 39, 241, 51, 244, 170, 230, 223, 180, 104, 178, 152, 158,
					129, 191, 202, 225, 226, 43, 230, 146, 22, 194, 193, 46, 250, 18, 83, 216,
					107, 198, 68, 250, 125, 21, 32, 79, 120, 33, 28, 244, 203, 177, 203, 34,
					247, 210, 129, 28, 131, 104, 219, 112, 248, 23, 75, 95, 222, 159, 83, 62,
					7, 214, 130, 204, 69, 247, 67, 146, 125, 158, 137, 190, 212, 194, 223, 89,
					94, 234, 131, 29, 78, 132, 51, 180, 78, 235, 8, 78, 81, 100, 66, 191,
					247, 172, 172, 191, 150, 251, 163, 205, 35, 136, 112, 9, 93, 159, 44, 173,
					9, 17, 3, 186, 203, 70, 205, 156, 104, 180, 247, 223, 126, 251, 254, 175,
					214, 116, 232, 198, 171, 53, 114, 32, 103, 27, 164, 72, 185, 95, 97, 188,
					247, 165, 57, 22, 60, 193, 206, 235, 129, 15, 38, 211, 235, 161, 127, 91,
					71, 221, 55, 136, 224, 67, 144, 156, 100, 11, 136, 175, 207, 110, 243, 13,
					198, 59, 180, 128, 250, 17, 110, 64, 247, 40, 155, 74, 117, 58, 7, 173,
					10, 124, 111, 203, 177, 240, 98, 219, 229, 114, 8, 229, 181, 107, 227, 23,
					101, 199, 75, 62, 148, 189, 125, 191, 255, 145, 67, 16, 230, 221, 96, 69,
					138, 56, 73, 197, 226, 222, 170, 29, 247, 147, 54, 186, 49, 93, 102, 78,
					95, 240, 165, 18, 37, 189, 125, 170, 87, 114, 188, 220, 78, 78, 228, 34,
					102, 70, 1, 211, 244, 146, 23, 144, 196, 114, 106, 251, 143, 63, 226, 135,
					253, 98, 234, 207, 150, 254, 223, 220, 229, 71, 71, 153, 17, 211, 213, 77,
					200, 119, 36, 65, 114, 237, 68, 151, 0, 82, 237, 46, 17, 170, 97, 206,
					22, 180, 186, 84, 237, 180, 210, 92, 238, 197, 100, 235, 36, 238, 99, 39,
					87, 197, 204, 124, 167, 246, 65, 136, 96, 24, 198, 55, 186, 108, 184, 64,
					84, 198, 140, 203, 149, 169, 37, 207, 231, 22, 148, 21, 219, 171, 222, 186,
					228, 228, 15, 197, 222, 189, 116, 203, 79, 81, 103, 240, 220, 63, 77, 39,
					193, 133, 0, 30, 196, 208, 96, 211, 29, 42, 100, 209, 103, 65, 157, 75,
					73, 80, 77, 86, 53, 242, 74, 208, 57, 237, 160, 159, 34, 184, 126, 111,
					22, 218, 216, 59, 204, 61, 88, 218, 158, 179, 194, 115, 72, 20, 226, 85,
					201, 132, 177, 119, 216, 93, 160, 181, 134, 248, 217, 211, 13, 242, 173, 36,
					82, 64, 125, 45, 17, 66, 138, 15, 135, 3, 238, 179, 242, 119, 238, 53,
					197, 210, 48, 224, 65, 240, 209, 209, 112, 190, 138, 199, 8, 20, 45, 175,
					218, 140, 47, 87, 168, 69, 96, 60, 151, 112, 254, 14, 161, 2, 40, 247,
					107, 5, 98, 244, 72, 174, 33, 253, 42, 105, 165, 7, 156, 59, 225, 30,
					129, 252, 89, 110, 43, 139, 198, 209, 177, 167, 204, 8, 110, 98, 213, 118,
					11, 197, 141, 46, 143, 135, 67, 236, 104, 32, 140, 76, 206, 229, 242, 177,
					165, 4, 75, 121, 242, 182, 16, 24, 19, 211, 246, 157, 88, 218, 42, 32,
					131, 142, 230, 186, 40, 4, 158, 212, 210, 241, 8, 104, 66, 194, 13, 35,
					135, 217, 61, 85, 22, 61, 105, 224, 207, 64, 82, 201, 51, 211, 196, 121,
					133, 37, 146, 145, 4, 58, 209, 56, 106, 173, 166, 95, 45, 19, 21, 209,
					129, 48, 216, 184, 125, 61, 101, 86, 84, 126, 30, 112, 251, 240, 234, 36,
					52, 12, 92, 155, 57, 137, 210, 147, 42, 254, 147, 152, 159, 229, 21, 123,
					105, 159, 55, 151, 94, 137, 214, 142, 90, 156, 139, 17, 43, 147, 163, 217,
					210, 129, 111, 65, 51, 76, 63, 77, 108, 234, 251, 227, 59, 166, 20, 223,
					71, 243, 188, 179, 147, 66, 125, 209, 218, 231, 99, 180, 77, 58, 110, 36,
					163, 84, 189, 173, 195, 4, 17, 163, 89, 160, 102, 160, 65, 247, 48, 120,
					92, 177, 76, 158, 191, 23, 88, 137, 202, 202, 142, 93, 231, 17, 85, 32,
					98, 80, 219, 38, 143, 75, 72, 182, 9, 111, 85, 58, 160, 189, 85, 38,
					223, 249, 86, 198, 64, 153, 208, 191, 46, 18, 55, 78, 169, 72, 146, 205,
					68, 216, 194, 146, 131, 132, 170, 154, 10, 204, 37, 8, 234, 231, 126, 110,
					106, 117, 214, 83, 214, 120, 200, 89, 49, 19, 61, 158, 116, 247, 165, 172,
					91, 183, 8, 165, 238, 81, 9, 129, 135, 233, 29, 27, 72, 184, 187, 8,
					67, 151, 140, 45, 215, 38, 190, 226, 32, 201, 186, 224, 104, 140, 229, 168,
					218, 209, 6, 154, 63, 183, 151, 134, 100, 193, 113, 216, 213, 108, 101, 121,
					118, 53, 137, 137, 177, 20, 14, 78, 46, 70, 107, 109, 194, 96, 168, 124,
					68, 238, 88, 153, 86, 152, 131, 129, 240, 202, 91, 38, 100, 31, 162, 70,
					166, 202, 241, 115, 200, 35, 55, 95, 122, 67, 225, 92, 232, 184, 196, 36,
					231, 207, 129, 154, 48, 24, 55, 7, 228, 45, 143, 36, 26, 19, 252, 53,
					253, 107, 137, 33, 225, 113, 13, 101, 18, 217, 149, 84, 246, 245, 238, 28,
					170, 171, 69, 34, 58, 169, 182, 90, 219, 22, 0, 192, 105, 242, 15, 252,
					117, 69, 226, 232, 33, 155, 113, 244, 146, 117, 249, 207, 226, 154, 95, 78,
					16, 198, 22, 228, 31, 177, 62, 41, 64, 231, 213, 203, 83, 194, 50, 24,
					138, 62, 79, 117, 221, 212, 135, 234, 130, 188, 27, 173, 149, 170, 7, 176,
					21, 2, 187, 193, 208, 158, 121, 67, 145, 91, 23, 180, 243, 197, 51, 45,
					225, 60, 71, 13, 63, 249, 202, 142, 116, 107, 217, 79, 133, 216, 46, 232,
					124, 13, 218, 147, 223, 5, 22, 40, 86, 108, 67, 174, 28, 92, 210, 72,
					168, 126, 255, 115, 248, 92, 226, 222, 39, 67, 138, 192, 38, 184, 194, 95,
					125, 104, 61, 137, 159, 161, 87, 53, 255, 166, 69, 147, 197, 244, 180}),
				cnter},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if got := tnt2Machine.engine; !reflect.DeepEqual(got, tt.want) {
				t.Errorf("Tnt2Engine.Engine() = %v, want %v", got, tt.want[:8])
			}
		})
	}
}

func TestTnt2Engine_MaximalStates(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	want, _ := new(big.Int).SetString("81526146660768170171574806347047854475", 10)
	tests := []struct {
		name string
		want *big.Int
	}{
		{
			name: "tteset1",
			want: want,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			if got := e.MaximalStates(); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("Tnt2Engine.MaximalStates() = %v, want %v", got, tt.want)
			}
		})
	}
}

func TestTnt2Engine_BuildCipherMachine(t *testing.T) {
	var tnt2Machine Tnt2Engine
	tnt2Machine.Init([]byte("SecretKey"), "")
	tests := []struct {
		name string
	}{
		// TODO: Add test cases.
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			e := tnt2Machine
			e.BuildCipherMachine()
		})
	}
}

func Test_createProFormaMachine(t *testing.T) {
	proFormaFile, err := os.Open("./files/test.proforma.json")
	checkFatal(err)
	defer proFormaFile.Close()

	type args struct {
		pfmReader io.Reader
	}
	tests := []struct {
		name string
		args args
		want *[]Crypter
	}{
		{
			name: "tcpfm1",
			args: args{pfmReader: nil},
			want: &[]Crypter{proFormaRotors[0], proFormaRotors[1], proFormPermutators[0], proFormaRotors[2], proFormaRotors[3], proFormPermutators[1], proFormaRotors[4], proFormaRotors[5]},
		},
		{
			name: "tcpfm1",
			args: args{pfmReader: bufio.NewReader(proFormaFile)},
			want: &[]Crypter{
				new(Rotor).New(1783, 610, 1171, []byte{
					82, 79, 214, 126, 124, 24, 21, 75, 235, 217, 180, 22, 1, 71, 68, 133,
					95, 241, 169, 230, 246, 231, 158, 254, 23, 166, 28, 224, 245, 79, 109, 110,
					197, 17, 182, 239, 56, 20, 192, 26, 254, 99, 104, 255, 138, 90, 112, 238,
					129, 206, 90, 206, 191, 254, 124, 18, 188, 172, 43, 238, 166, 12, 187, 221,
					154, 91, 203, 171, 251, 1, 0, 46, 0, 154, 195, 135, 177, 28, 230, 171,
					57, 242, 222, 209, 212, 228, 72, 151, 177, 202, 54, 56, 115, 195, 225, 89,
					81, 138, 173, 104, 20, 160, 135, 32, 190, 197, 53, 23, 250, 67, 217, 245,
					233, 220, 58, 24, 32, 74, 197, 44, 154, 182, 23, 110, 177, 107, 89, 94,
					213, 213, 210, 140, 172, 234, 166, 139, 105, 230, 93, 65, 254, 47, 152, 34,
					89, 144, 84, 176, 81, 217, 121, 90, 14, 253, 37, 254, 168, 127, 174, 29,
					158, 5, 14, 65, 250, 117, 169, 135, 17, 135, 167, 42, 211, 103, 99, 128,
					202, 129, 122, 32, 187, 171, 249, 142, 253, 162, 107, 211, 122, 57, 129, 131,
					43, 112, 122, 177, 134, 150, 232, 101, 159, 21, 201, 253, 218, 161, 250, 141,
					218, 60, 36, 183, 162, 111, 160, 74, 186, 52, 253, 252, 219, 140, 71, 169,
					39, 107, 63, 62, 140, 138, 165, 245, 108, 90, 139, 128, 35, 162, 194, 175,
					248, 84, 115, 251, 115, 79, 255, 11, 83, 14, 240, 250, 167, 54, 55}),
				new(Rotor).New(1789, 855, 1006, []byte{
					193, 24, 147, 110, 223, 17, 7, 135, 69, 144, 62, 75, 94, 8, 147, 135,
					8, 240, 252, 223, 37, 118, 190, 21, 78, 252, 24, 83, 55, 13, 98, 154,
					217, 91, 177, 196, 136, 86, 127, 121, 31, 156, 254, 239, 44, 164, 206, 27,
					17, 184, 159, 197, 92, 170, 72, 223, 17, 165, 193, 164, 61, 183, 194, 250,
					18, 142, 151, 216, 82, 141, 163, 238, 33, 232, 92, 61, 207, 204, 176, 201,
					179, 94, 18, 29, 101, 118, 104, 175, 112, 167, 4, 79, 82, 41, 202, 80,
					99, 144, 57, 82, 54, 94, 7, 141, 139, 35, 18, 48, 109, 30, 145, 220,
					11, 144, 31, 94, 70, 147, 118, 68, 176, 69, 116, 31, 66, 193, 107, 104,
					201, 191, 193, 198, 14, 199, 102, 219, 98, 72, 83, 190, 211, 73, 84, 82,
					5, 64, 140, 145, 245, 154, 52, 108, 18, 240, 85, 247, 79, 213, 72, 51,
					97, 111, 255, 141, 216, 41, 189, 136, 22, 165, 80, 135, 125, 250, 67, 21,
					45, 60, 202, 64, 243, 141, 84, 226, 44, 210, 218, 216, 156, 104, 198, 105,
					1, 39, 229, 144, 104, 48, 202, 128, 142, 178, 130, 214, 214, 177, 73, 193,
					39, 242, 193, 0, 165, 150, 68, 95, 93, 36, 67, 67, 194, 148, 253, 49,
					24, 99, 210, 237, 59, 226, 224, 176, 8, 210, 103, 201, 11, 97, 242, 16,
					1, 158, 255, 187, 196, 206, 183, 194, 137, 31, 99, 234, 166, 65, 76, 211}),
				new(Permutator).New([]int{47, 53, 71, 85}, []byte{
					186, 195, 208, 43, 241, 187, 150, 185, 37, 165, 11, 194, 51, 159, 234, 73,
					81, 203, 90, 249, 89, 14, 52, 100, 86, 212, 12, 57, 60, 139, 145, 193,
					98, 7, 151, 143, 213, 119, 149, 111, 56, 130, 239, 41, 15, 233, 20, 231,
					243, 6, 46, 0, 238, 123, 227, 13, 79, 1, 71, 220, 192, 138, 158, 45,
					189, 49, 105, 64, 44, 84, 33, 176, 182, 137, 122, 32, 47, 80, 146, 179,
					170, 65, 155, 178, 140, 184, 21, 134, 99, 118, 136, 95, 125, 103, 219, 169,
					228, 226, 196, 225, 66, 223, 107, 167, 204, 67, 10, 23, 69, 148, 141, 42,
					172, 166, 3, 255, 25, 214, 198, 161, 97, 94, 115, 72, 75, 54, 250, 55,
					101, 50, 29, 237, 87, 218, 16, 174, 110, 28, 229, 77, 211, 128, 183, 215,
					240, 38, 36, 242, 17, 39, 246, 88, 82, 62, 40, 181, 92, 129, 154, 53,
					48, 9, 63, 83, 157, 222, 171, 207, 135, 153, 209, 144, 163, 26, 152, 142,
					232, 76, 247, 96, 58, 191, 35, 117, 164, 4, 200, 251, 124, 5, 113, 197,
					217, 147, 210, 162, 59, 109, 173, 68, 248, 8, 78, 244, 112, 201, 175, 19,
					74, 131, 24, 188, 114, 30, 22, 106, 104, 236, 245, 235, 31, 230, 133, 252,
					205, 2, 180, 168, 132, 221, 116, 121, 70, 93, 224, 160, 253, 108, 91, 156,
					127, 85, 199, 206, 254, 34, 202, 61, 18, 126, 190, 120, 177, 27, 216, 102}),
				new(Rotor).New(1747, 1152, 1582, []byte{
					213, 45, 70, 99, 23, 96, 134, 121, 223, 237, 102, 55, 28, 112, 47, 7,
					136, 105, 22, 24, 38, 234, 52, 98, 12, 51, 115, 44, 149, 49, 93, 171,
					240, 95, 10, 128, 114, 26, 143, 110, 126, 76, 124, 35, 64, 73, 122, 73,
					154, 23, 214, 79, 204, 244, 233, 35, 248, 51, 164, 94, 156, 201, 46, 226,
					68, 127, 98, 114, 98, 226, 5, 167, 200, 18, 5, 236, 156, 120, 208, 226,
					21, 64, 47, 30, 193, 127, 231, 200, 105, 191, 93, 184, 193, 38, 192, 158,
					93, 177, 235, 27, 171, 5, 207, 24, 133, 157, 98, 252, 141, 0, 43, 53,
					81, 53, 36, 115, 183, 191, 7, 127, 45, 147, 153, 253, 232, 142, 89, 214,
					160, 185, 217, 171, 113, 28, 3, 150, 103, 125, 148, 130, 70, 70, 170, 78,
					238, 154, 88, 185, 214, 41, 183, 181, 56, 74, 190, 22, 56, 97, 55, 55,
					124, 204, 186, 121, 3, 217, 154, 2, 137, 204, 8, 180, 242, 154, 199, 30,
					12, 47, 57, 54, 1, 81, 30, 49, 242, 1, 76, 95, 124, 25, 178, 224,
					99, 175, 146, 99, 245, 247, 109, 5, 21, 194, 51, 57, 227, 255, 48, 18,
					2, 139, 163, 119, 103, 253, 56, 43, 161, 167, 169, 110, 49, 26, 187, 0,
					51, 204, 251, 110, 55, 187, 225, 128, 123, 57, 64, 76, 179, 192, 48, 81,
					167, 17, 99, 152, 153, 99, 169, 140, 233, 90, 141}),
				new(Rotor).New(1723, 1202, 434, []byte{
					66, 39, 160, 100, 130, 235, 238, 29, 86, 217, 124, 43, 223, 11, 155, 64,
					106, 220, 62, 0, 245, 177, 250, 36, 84, 35, 250, 31, 58, 34, 70, 142,
					186, 25, 226, 91, 177, 112, 151, 161, 75, 227, 134, 63, 132, 35, 11, 129,
					106, 86, 192, 77, 117, 62, 138, 250, 26, 241, 157, 139, 123, 74, 21, 227,
					232, 180, 108, 52, 185, 35, 66, 29, 216, 223, 119, 166, 31, 94, 99, 252,
					81, 239, 152, 225, 135, 170, 205, 102, 101, 211, 19, 124, 172, 55, 235, 81,
					206, 75, 159, 189, 53, 88, 105, 9, 151, 16, 246, 244, 171, 64, 24, 141,
					139, 79, 164, 83, 253, 77, 203, 86, 65, 3, 168, 132, 222, 97, 152, 94,
					208, 141, 185, 128, 214, 56, 107, 34, 102, 128, 94, 106, 113, 38, 175, 19,
					57, 2, 161, 231, 21, 22, 214, 87, 113, 21, 9, 140, 176, 77, 109, 178,
					4, 87, 121, 144, 33, 40, 138, 173, 208, 13, 186, 123, 95, 234, 67, 129,
					37, 63, 44, 111, 146, 185, 175, 93, 151, 183, 95, 64, 135, 30, 10, 51,
					98, 56, 3, 81, 185, 221, 182, 252, 22, 9, 20, 142, 150, 209, 211, 79,
					139, 114, 182, 147, 134, 12, 81, 18, 58, 1, 37, 19, 92, 119, 239, 176,
					202, 230, 91, 249, 94, 216, 4, 82, 227, 246, 1, 168, 143, 213, 39, 161,
					26, 209, 255, 208, 17, 49, 114, 28}),
				new(Permutator).New([]int{43, 57, 73, 83}, []byte{
					212, 87, 65, 20, 52, 6, 194, 73, 229, 105, 101, 153, 24, 220, 57, 119,
					139, 32, 61, 246, 245, 117, 136, 92, 128, 16, 3, 88, 214, 41, 164, 241,
					50, 193, 182, 187, 172, 234, 69, 127, 240, 252, 53, 192, 25, 123, 4, 99,
					208, 29, 76, 11, 60, 223, 161, 176, 201, 114, 202, 180, 93, 132, 211, 77,
					23, 79, 107, 237, 112, 130, 59, 185, 213, 243, 160, 37, 94, 196, 19, 28,
					204, 18, 13, 156, 95, 109, 143, 158, 152, 113, 56, 80, 188, 33, 251, 189,
					62, 134, 238, 46, 167, 115, 210, 184, 218, 166, 141, 2, 22, 26, 248, 96,
					38, 200, 30, 144, 253, 110, 111, 232, 51, 63, 169, 230, 154, 254, 142, 163,
					64, 100, 44, 40, 118, 103, 175, 181, 7, 205, 203, 207, 242, 219, 199, 71,
					54, 227, 122, 222, 47, 1, 231, 135, 68, 147, 48, 108, 116, 133, 84, 198,
					186, 165, 49, 250, 31, 216, 12, 81, 236, 82, 74, 149, 138, 170, 178, 224,
					150, 97, 239, 159, 247, 75, 39, 249, 8, 36, 129, 225, 131, 183, 228, 27,
					70, 217, 121, 124, 151, 66, 104, 206, 45, 148, 173, 34, 235, 43, 78, 67,
					146, 14, 244, 9, 179, 55, 10, 15, 83, 98, 197, 85, 120, 140, 125, 0,
					195, 89, 137, 155, 126, 35, 174, 177, 209, 157, 86, 190, 72, 91, 162, 90,
					255, 168, 21, 191, 42, 58, 215, 17, 226, 233, 145, 5, 106, 171, 102, 221}),
				new(Rotor).New(1669, 1289, 1296, []byte{
					208, 10, 186, 231, 85, 248, 98, 6, 60, 154, 20, 170, 122, 16, 212, 95,
					149, 199, 213, 41, 16, 10, 130, 40, 214, 65, 79, 110, 249, 46, 96, 189,
					53, 112, 57, 72, 27, 208, 216, 210, 188, 45, 182, 191, 127, 97, 21, 43,
					158, 212, 27, 134, 55, 208, 54, 194, 45, 187, 148, 171, 66, 141, 67, 207,
					177, 213, 4, 163, 186, 226, 116, 186, 75, 40, 51, 121, 66, 2, 204, 50,
					74, 230, 55, 123, 215, 50, 136, 58, 7, 147, 241, 58, 137, 115, 87, 225,
					166, 82, 192, 216, 99, 155, 175, 119, 12, 68, 34, 251, 225, 156, 159, 50,
					161, 53, 209, 30, 130, 158, 221, 249, 219, 152, 185, 158, 72, 10, 126, 113,
					245, 145, 7, 7, 252, 150, 232, 173, 73, 149, 246, 251, 208, 104, 55, 236,
					85, 41, 5, 160, 34, 183, 164, 168, 233, 170, 213, 200, 85, 160, 160, 205,
					187, 216, 202, 178, 137, 119, 179, 18, 74, 232, 184, 221, 91, 209, 55, 229,
					49, 120, 60, 235, 214, 8, 92, 128, 177, 22, 102, 145, 42, 224, 203, 65,
					53, 127, 186, 250, 193, 61, 39, 199, 146, 122, 0, 228, 77, 2, 140, 100,
					5, 90, 65, 247, 188, 10, 95, 204, 128, 71, 147, 66, 85, 15, 130, 250,
					171, 242, 184, 58, 5, 66, 65, 16, 197, 58, 232, 201, 45, 223, 5, 172,
					23}),
				new(Rotor).New(1759, 1128, 1326, []byte{
					149, 80, 148, 9, 33, 13, 106, 38, 188, 124, 46, 152, 113, 34, 83, 2,
					44, 223, 57, 218, 215, 190, 75, 153, 13, 17, 19, 16, 130, 215, 100, 63,
					135, 40, 198, 206, 188, 17, 112, 239, 137, 95, 166, 254, 28, 253, 197, 158,
					155, 160, 37, 210, 238, 7, 118, 253, 213, 34, 97, 209, 225, 243, 121, 50,
					125, 210, 40, 238, 69, 110, 3, 110, 93, 187, 158, 183, 246, 72, 117, 207,
					95, 22, 216, 188, 210, 123, 255, 237, 18, 188, 123, 110, 205, 162, 235, 34,
					239, 250, 164, 41, 231, 91, 238, 85, 133, 151, 81, 221, 72, 124, 59, 77,
					129, 191, 101, 108, 174, 214, 196, 66, 139, 26, 249, 231, 47, 239, 216, 195,
					225, 160, 69, 1, 120, 27, 146, 9, 96, 172, 103, 6, 221, 31, 213, 20,
					254, 163, 29, 70, 170, 50, 236, 233, 215, 173, 10, 228, 251, 163, 93, 171,
					186, 203, 248, 76, 31, 105, 44, 5, 22, 220, 199, 153, 176, 161, 187, 217,
					207, 142, 141, 138, 75, 134, 76, 207, 189, 60, 228, 13, 61, 12, 204, 123,
					29, 181, 241, 172, 219, 58, 202, 110, 233, 54, 39, 96, 57, 95, 1, 94,
					105, 162, 59, 26, 84, 77, 8, 82, 253, 29, 2, 199, 74, 40, 202, 132,
					144, 6, 53, 19, 94, 62, 23, 204, 56, 145, 41, 1, 150, 239, 28, 237,
					107, 223, 165, 204, 134, 136, 9, 8, 193, 107, 178, 31})},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if got := createProFormaMachine(tt.args.pfmReader); got == tt.want {
				t.Errorf("createProFormaMachine() = %v, want %v", got, tt.want)
			}
		})
	}
}
